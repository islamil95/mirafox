/*!
 * jScrollPane - v2.0.0beta11 - 2011-06-11
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
!function(e,t,n){e.fn.jScrollPane=function(t){function i(t,i){function o(i){var r,c,p,u,d,j,g=!1,v=!1;if(G=i,q===n)d=t.scrollTop(),j=t.scrollLeft(),t.css({overflow:"hidden",padding:0}),V=t.innerWidth()+be,E=t.innerHeight(),t.width(V),q=e('<div class="jspPane" />').css("padding",me).append(t.children()),O=e('<div class="jspContainer" />').css({width:V+"px",height:E+"px"}).append(q).appendTo(t);else{if(t.css("width",""),g=G.stickToBottom&&H(),v=G.stickToRight&&S(),(u=t.innerWidth()+be!=V||t.outerHeight()!=E)&&(V=t.innerWidth()+be,E=t.innerHeight(),O.css({width:V+"px",height:E+"px"})),!u&&we==N&&q.outerHeight()==K)return void t.width(V);we=N,q.css("width",""),t.width(V),O.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}q.css("overflow","auto"),N=i.contentWidth?i.contentWidth:q[0].scrollWidth,K=q[0].scrollHeight,q.css("overflow",""),$=(U=K/E)>1,(J=(Q=N/V)>1)||$?(t.addClass("jspScrollable"),(r=G.maintainPosition&&(ee||ie))&&(c=B(),p=D()),s(),a(),l(),r&&(C(v?N-V:c,!1),y(g?K-E:p,!1)),x(),P(),L(),G.enableKeyboardNavigation&&M(),G.clickOnTrack&&f(),R(),G.hijackInternalLinks&&I()):(t.removeClass("jspScrollable"),q.css({top:0,width:O.width()-be}),A(),Y(),X(),h(),z()),G.autoReinitialise&&!ve?ve=setInterval(function(){o(G)},G.autoReinitialiseDelay):!G.autoReinitialise&&ve&&clearInterval(ve),d&&t.scrollTop(0)&&y(d,!1),j&&t.scrollLeft(0)&&C(j,!1),t.trigger("jsp-initialised",[J||$])}function s(){$&&(O.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />'))),oe=O.find(">.jspVerticalBar"),se=oe.find(">.jspTrack"),Z=se.find(">.jspDrag"),G.showArrows&&(le=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",u(0,-1)).bind("click.jsp",W),pe=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",u(0,1)).bind("click.jsp",W),G.arrowScrollOnHover&&(le.bind("mouseover.jsp",u(0,-1,le)),pe.bind("mouseover.jsp",u(0,1,pe))),p(se,G.verticalArrowPositions,le,pe)),ae=E,O.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ae-=e(this).outerHeight()}),Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",W),Z.addClass("jspActive");var n=t.pageY-Z.position().top;return e("html").bind("mousemove.jsp",function(e){g(e.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",j),!1}),r())}function r(){se.height(ae+"px"),ee=0,re=G.verticalGutter+se.outerWidth(),q.width(V-re-be);try{0===oe.position().left&&q.css("margin-left",re+"px")}catch(e){}}function a(){J&&(O.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />'))),ue=O.find(">.jspHorizontalBar"),de=ue.find(">.jspTrack"),te=de.find(">.jspDrag"),G.showArrows&&(je=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",u(-1,0)).bind("click.jsp",W),ge=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",u(1,0)).bind("click.jsp",W),G.arrowScrollOnHover&&(je.bind("mouseover.jsp",u(-1,0,je)),ge.bind("mouseover.jsp",u(1,0,ge))),p(de,G.horizontalArrowPositions,je,ge)),te.hover(function(){te.addClass("jspHover")},function(){te.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",W),te.addClass("jspActive");var n=t.pageX-te.position().left;return e("html").bind("mousemove.jsp",function(e){m(e.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",j),!1}),fe=O.innerWidth(),c())}function c(){O.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){fe-=e(this).outerWidth()}),de.width(fe+"px"),ie=0}function l(){if(J&&$){var t=de.outerHeight(),n=se.outerWidth();ae-=t,e(ue).find(">.jspCap:visible,>.jspArrow").each(function(){fe+=e(this).outerWidth()}),fe-=n,E-=n,V-=t,de.parent().append(e('<div class="jspCorner" />').css("width",t+"px")),r(),c()}J&&q.width(O.outerWidth()-be+"px"),K=q.outerHeight(),U=K/E,J&&((he=Math.ceil(1/Q*fe))>G.horizontalDragMaxWidth?he=G.horizontalDragMaxWidth:he<G.horizontalDragMinWidth&&(he=G.horizontalDragMinWidth),te.width(he+"px"),ne=fe-he,b(ie)),$&&((ce=Math.ceil(1/U*ae))>G.verticalDragMaxHeight?ce=G.verticalDragMaxHeight:ce<G.verticalDragMinHeight&&(ce=G.verticalDragMinHeight),Z.height(ce+"px"),_=ae-ce,v(ee))}function p(e,t,n,i){var o,s="before",r="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==s?r=t:t==r&&(s=t,o=n,n=i,i=o),e[s](n)[r](i)}function u(e,t,n){return function(){return d(e,t,this,n),this.blur(),!1}}function d(t,n,i,o){i=e(i).addClass("jspActive");var s,r,a=!0,c=function(){0!==t&&ke.scrollByX(t*G.arrowButtonSpeed),0!==n&&ke.scrollByY(n*G.arrowButtonSpeed),r=setTimeout(c,a?G.initialDelay:G.arrowRepeatFreq),a=!1};c(),s=o?"mouseout.jsp":"mouseup.jsp",(o=o||e("html")).bind(s,function(){i.removeClass("jspActive"),r&&clearTimeout(r),r=null,o.unbind(s)})}function f(){h(),$&&se.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var i,o=e(this),s=o.offset(),r=t.pageY-s.top-ee,a=!0,c=function(){var e=o.offset(),n=t.pageY-e.top-ce/2,s=E*G.scrollPagePercent,p=_*s/(K-E);if(r<0)ee-p>n?ke.scrollByY(-s):g(n);else{if(!(r>0))return void l();ee+p<n?ke.scrollByY(s):g(n)}i=setTimeout(c,a?G.initialDelay:G.trackClickRepeatFreq),a=!1},l=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",l)};return c(),e(document).bind("mouseup.jsp",l),!1}}),J&&de.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var i,o=e(this),s=o.offset(),r=t.pageX-s.left-ie,a=!0,c=function(){var e=o.offset(),n=t.pageX-e.left-he/2,s=V*G.scrollPagePercent,p=ne*s/(N-V);if(r<0)ie-p>n?ke.scrollByX(-s):m(n);else{if(!(r>0))return void l();ie+p<n?ke.scrollByX(s):m(n)}i=setTimeout(c,a?G.initialDelay:G.trackClickRepeatFreq),a=!1},l=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",l)};return c(),e(document).bind("mouseup.jsp",l),!1}})}function h(){de&&de.unbind("mousedown.jsp"),se&&se.unbind("mousedown.jsp")}function j(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Z&&Z.removeClass("jspActive"),te&&te.removeClass("jspActive")}function g(e,t){$&&(e<0?e=0:e>_&&(e=_),t===n&&(t=G.animateScroll),t?ke.animate(Z,"top",e,v):(Z.css("top",e),v(e)))}function v(e){e===n&&(e=Z.position().top),O.scrollTop(0);var i=0===(ee=e),o=ee==_,s=-(e/_)*(K-E);ye==i&&Te==o||(ye=i,Te=o,t.trigger("jsp-arrow-change",[ye,Te,Ce,Be])),w(i,o),q.css("top",s),t.trigger("jsp-scroll-y",[-s,i,o]).trigger("scroll")}function m(e,t){J&&(e<0?e=0:e>ne&&(e=ne),t===n&&(t=G.animateScroll),t?ke.animate(te,"left",e,b):(te.css("left",e),b(e)))}function b(e){e===n&&(e=te.position().left),O.scrollTop(0);var i=0===(ie=e),o=ie==ne,s=-(e/ne)*(N-V);Ce==i&&Be==o||(Ce=i,Be=o,t.trigger("jsp-arrow-change",[ye,Te,Ce,Be])),k(i,o),q.css("left",s),t.trigger("jsp-scroll-x",[-s,i,o]).trigger("scroll")}function w(e,t){G.showArrows&&(le[e?"addClass":"removeClass"]("jspDisabled"),pe[t?"addClass":"removeClass"]("jspDisabled"))}function k(e,t){G.showArrows&&(je[e?"addClass":"removeClass"]("jspDisabled"),ge[t?"addClass":"removeClass"]("jspDisabled"))}function y(e,t){g(e/(K-E)*_,t)}function C(e,t){m(e/(N-V)*ne,t)}function T(t,n,i){var o,s,r,a,c,l,p,u,d,f=0,h=0;try{o=e(t)}catch(e){return}for(s=o.outerHeight(),r=o.outerWidth(),O.scrollTop(0),O.scrollLeft(0);!o.is(".jspPane");)if(f+=o.position().top,h+=o.position().left,o=o.offsetParent(),/^body|html$/i.test(o[0].nodeName))return;l=(a=D())+E,f<a||n?u=f-G.verticalGutter:f+s>l&&(u=f-E+s+G.verticalGutter),u&&y(u,i),p=(c=B())+V,h<c||n?d=h-G.horizontalGutter:h+r>p&&(d=h-V+r+G.horizontalGutter),d&&C(d,i)}function B(){return-q.position().left}function D(){return-q.position().top}function H(){var e=K-E;return e>20&&e-D()<10}function S(){var e=N-V;return e>20&&e-B()<10}function P(){O.unbind(He).bind(He,function(e,t,n,i){var o=ie,s=ee;return ke.scrollBy(n*G.mouseWheelSpeed,-i*G.mouseWheelSpeed,!1),o==ie&&s==ee})}function A(){O.unbind(He)}function W(){return!1}function x(){q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){T(e.target,!1)})}function Y(){q.find(":input,a").unbind("focus.jsp")}function M(){function n(){var e=ie,t=ee;switch(i){case 40:ke.scrollByY(G.keyboardSpeed,!1);break;case 38:ke.scrollByY(-G.keyboardSpeed,!1);break;case 34:case 32:ke.scrollByY(E*G.scrollPagePercent,!1);break;case 33:ke.scrollByY(-E*G.scrollPagePercent,!1);break;case 39:ke.scrollByX(G.keyboardSpeed,!1);break;case 37:ke.scrollByX(-G.keyboardSpeed,!1)}return o=e!=ie||t!=ee}var i,o,s=[];J&&s.push(ue[0]),$&&s.push(oe[0]),q.focus(function(){t.focus()}),t.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(t){if(t.target===this||s.length&&e(t.target).closest(s).length){var r=ie,a=ee;switch(t.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:i=t.keyCode,n();break;case 35:y(K-E),i=null;break;case 36:y(0),i=null}return!(o=t.keyCode==i&&r!=ie||a!=ee)}}).bind("keypress.jsp",function(e){return e.keyCode==i&&n(),!o}),G.hideFocus?(t.css("outline","none"),"hideFocus"in O[0]&&t.attr("hideFocus",!0)):(t.css("outline",""),"hideFocus"in O[0]&&t.attr("hideFocus",!1))}function X(){t.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function R(){if(location.hash&&location.hash.length>1){var t,n,i=escape(location.hash);try{t=e(i)}catch(e){return}t.length&&q.find(i)&&(0===O.scrollTop()?n=setInterval(function(){O.scrollTop()>0&&(T(i,!0),e(document).scrollTop(O.position().top),clearInterval(n))},50):(T(i,!0),e(document).scrollTop(O.position().top)))}}function z(){e("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function I(){z(),e("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var e,t=this.href.split("#");if(t.length>1&&(e=t[1]).length>0&&q.find("#"+e).length>0)return T("#"+e,!0),!1})}function L(){var e,t,n,i,o,s=!1;O.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(r){var a=r.originalEvent.touches[0];e=B(),t=D(),n=a.pageX,i=a.pageY,o=!1,s=!0}).bind("touchmove.jsp",function(r){if(s){var a=r.originalEvent.touches[0],c=ie,l=ee;return ke.scrollTo(e+n-a.pageX,t+i-a.pageY),o=o||Math.abs(n-a.pageX)>5||Math.abs(i-a.pageY)>5,c==ie&&l==ee}}).bind("touchend.jsp",function(e){s=!1}).bind("click.jsp-touchclick",function(e){if(o)return o=!1,!1})}function F(){var e=D(),n=B();t.removeClass("jspScrollable").unbind(".jsp"),t.replaceWith(De.append(q.children())),De.scrollTop(e),De.scrollLeft(n)}var G,q,V,E,O,N,K,Q,U,$,J,Z,_,ee,te,ne,ie,oe,se,re,ae,ce,le,pe,ue,de,fe,he,je,ge,ve,me,be,we,ke=this,ye=!0,Ce=!0,Te=!1,Be=!1,De=t.clone(!1,!1).empty(),He=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";me=t.css("paddingTop")+" "+t.css("paddingRight")+" "+t.css("paddingBottom")+" "+t.css("paddingLeft"),be=(parseInt(t.css("paddingLeft"),10)||0)+(parseInt(t.css("paddingRight"),10)||0),e.extend(ke,{reinitialise:function(t){o(t=e.extend({},G,t))},scrollToElement:function(e,t,n){T(e,t,n)},scrollTo:function(e,t,n){C(e,n),y(t,n)},scrollToX:function(e,t){C(e,t)},scrollToY:function(e,t){y(e,t)},scrollToPercentX:function(e,t){C(e*(N-V),t)},scrollToPercentY:function(e,t){y(e*(K-E),t)},scrollBy:function(e,t,n){ke.scrollByX(e,n),ke.scrollByY(t,n)},scrollByX:function(e,t){m((B()+Math[e<0?"floor":"ceil"](e))/(N-V)*ne,t)},scrollByY:function(e,t){g((D()+Math[e<0?"floor":"ceil"](e))/(K-E)*_,t)},positionDragX:function(e,t){m(e,t)},positionDragY:function(e,t){g(e,t)},animate:function(e,t,n,i){var o={};o[t]=n,e.animate(o,{duration:G.animateDuration,ease:G.animateEase,queue:!1,step:i})},getContentPositionX:function(){return B()},getContentPositionY:function(){return D()},getContentWidth:function(){return N},getContentHeight:function(){return K},getPercentScrolledX:function(){return B()/(N-V)},getPercentScrolledY:function(){return D()/(K-E)},getIsScrollableH:function(){return J},getIsScrollableV:function(){return $},getContentPane:function(){return q},scrollToBottom:function(e){g(_,e)},hijackInternalLinks:function(){I()},destroy:function(){F()}}),o(i)}return t=e.extend({},e.fn.jScrollPane.defaults,t),e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){t[this]=t[this]||t.speed}),this.each(function(){var n=e(this),o=n.data("jsp");o?o.reinitialise(t):(o=new i(n,t),n.data("jsp",o))})},e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery);
