(function(d){var n=function(h,g){var a=this,l=Math.floor(100*Math.random())+Date.now();g=void 0===g?{}:g;var m={carousel:!0,items:4,multiple:!1,slidesContainer:h,slides:".cusongsblock",wrapperClass:"kwork-carousel-wrapper",itemClass:"kwork-carousel-item",storageClass:"kwork-carousel-storage",nextNavClass:"kwork-carousel-next",prevNavClass:"kwork-carousel-prev",animateDuration:80,margin:10,storageInMemory:!0,nav:!0,responsive:!1,staticFirst:!1},c=d.extend(m,g);a.currentItem=0;a.responsiveOptions=-1;
    a.visibleItems=0;a.totalItems=0;a.animation=!1;a.container=d(c.slidesContainer);a.nextFix=!1;a.prevFix=!1;a.init=function(){c.responsive&&(a.setupResponsive(),d(window).on("resize",function(){a.setupResponsive()&&a.resize()&&c.nav&&a.buildNav()}));a.buildWrapper()&&c.nav&&a.buildNav()};a.buildWrapper=function(){a.container.addClass("kwork-carousel-main-container");a.items=a.container.find(c.slides);a.totalItems=a.items.length;a.visibleItems=c.items;a.buildStorage();var b=0;a.items.each(function(){d(this).data("kwork-carousel-item-index",
        b);b++});if(a.visibleItems>=a.totalItems||!c.carousel)return a.container.append(a.items),!1;if(c.multiple&&(a.totalItems-=a.totalItems%a.visibleItems,a.totalItems<=a.visibleItems)){for(var f=0;f<a.totalItems;f++)a.container.append(a.items[f]);return!1}a.addTouchListeners();a.wrapper=d("<div>").addClass(c.wrapperClass).attr("id","kwork-carousel-"+l);for(f=0;f<a.visibleItems;f++){var e=d("<div>").addClass(c.itemClass);e.data("kwork-carousel-item-place-index",f);c.margin&&e.css("margin-right",c.margin);
        a.wrapper.append(e)}a.wrapper.find("."+c.itemClass).each(function(b){var e=d(this);a.items.each(function(){d(this).data("kwork-carousel-item-index")==b&&a.moveItemToItemplace(e,d(this),!0)})});a.container.prepend(a.wrapper);return!0};a.buildNav=function(){var b=d("<a>").attr("href","#").addClass(c.nextNavClass).addClass("kwork-carousel-nav-button"),f=d("<a>").attr("href","#").addClass(c.prevNavClass).addClass("kwork-carousel-nav-button");b.append(d("<span>").addClass("kwork-carousel-nav-button-inner").append(d("<i>").addClass("kwork-carousel-nav-button-icon")));
        f.append(d("<span>").addClass("kwork-carousel-nav-button-inner").append(d("<i>").addClass("kwork-carousel-nav-button-icon")));b.on("click",a.next);f.on("click",a.prev);var e=d("<div>").addClass("kwork-carousel-nav");e.append(f);e.append(b);a.nav=e;a.wrapper.parent().addClass("has-nav").append(e)};a.buildStorage=function(){a.storage=d("<div>").addClass(c.storageClass).attr("id","kwork-carousel-storage"+l).hide();a.items.removeClass("kwork-carousel-item-active");a.storage.append(a.items);c.storageInMemory||
    a.storage.appendTo(a.container)};a.next=function(){if(a.animation)return!1;a.nextFix=!1;a.animation=!0;var b=a.currentItem+a.visibleItems;a.prevFix&&(b-=a.visibleItems-a.totalItems%a.visibleItems,a.prevFix=!1);b>=a.totalItems?b-=a.totalItems:c.staticFirst&&b+a.visibleItems>a.totalItems&&a.totalItems%a.visibleItems&&(b-=a.visibleItems-a.totalItems%a.visibleItems,a.nextFix=!0,0>b&&(b+=a.totalItems));b=b+a.visibleItems-1;b>=a.totalItems&&(b-=a.totalItems);a.list(b,!0);return!1};a.prev=function(){if(a.animation)return!1;
        a.prevFix=!1;a.animation=!0;var b=a.currentItem-a.visibleItems;a.nextFix&&(b+=a.visibleItems-a.totalItems%a.visibleItems,a.nextFix=!1);0>b&&(b+=a.totalItems,c.staticFirst&&a.totalItems%a.visibleItems&&(b=b+a.visibleItems-a.totalItems%a.visibleItems,a.prevFix=!0));a.list(b,!1);return!1};a.list=function(b,f){var e=0,k=a.wrapper.find("."+c.itemClass);f&&(k=d(k.get().reverse()));var g=k.length;k.each(function(){var k=d(this),h=null;a.items.each(function(){d(this).data("kwork-carousel-item-index")==b&&
    (h=d(this))});setTimeout(function(){h&&a.moveItemToItemplace(k,h);g--;g||(a.animation=!1,a.wrapper.trigger("animationEnd"),a.currentItem=a.wrapper.find(c.slides).first().data("kworkCarouselItemIndex"))},c.animateDuration*e);e++;f?(b--,0>b&&(b+=a.totalItems)):(b++,b>=a.totalItems&&(b-=a.totalItems))})};a.moveItemToItemplace=function(b,c,e){e||b.children().first().removeClass("kwork-carousel-item-active").appendTo(a.storage);c.hasClass("kwork-carousel-item-active")?(e=c.clone().removeClass("kwork-carousel-item-active").addClass("kwork-carousel-item-clone"),
        b.append(e),a.wrapper.one("animationEnd",function(){b.children().first().remove();c.addClass("kwork-carousel-item-active");b.append(c)})):(c.addClass("kwork-carousel-item-active"),b.append(c))};a.setupResponsive=function(){var b=a.viewport(),f=c.responsive,e=-1;c=d.extend(m,g);d.each(f,function(a){a<=b&&a>e&&(e=Number(a))});return e!=a.responsiveOptions?(a.responsiveOptions=e,-1!=e&&(c=d.extend({},c,f[e])),!0):!1};a.resize=function(){a.totalItems=a.items.length;a.items.removeClass("kwork-carousel-item-active");
        a.storage.append(a.items);a.visibleItems=c.items;a.wrapper&&a.wrapper.remove();a.nav&&(a.wrapper.parent().removeClass("has-nav"),a.nav.remove());a.removerTouchListeners();if(a.visibleItems>=a.totalItems||!c.carousel)return a.container.append(a.items),!1;if(c.multiple&&(a.totalItems-=a.totalItems%a.visibleItems,a.totalItems<=a.visibleItems)){for(var b=0;b<a.totalItems;b++)a.container.append(a.items[b]);return!1}a.addTouchListeners();a.wrapper=d("<div>").addClass(c.wrapperClass).attr("id","kwork-carousel-"+
            l);for(b=0;b<a.visibleItems;b++){var f=d("<div>").addClass(c.itemClass);f.data("kwork-carousel-item-place-index",b);c.margin&&f.css("margin-right",c.margin);a.wrapper.append(f)}a.currentItem=0;a.wrapper.find("."+c.itemClass).each(function(b){var c=d(this);a.items.each(function(){d(this).data("kwork-carousel-item-index")==b&&a.moveItemToItemplace(c,d(this),!0)});b++});a.container.prepend(a.wrapper);return!0};a.getScrollbarWidth=function(){var a=document.createElement("div");a.style.visibility="hidden";
        a.style.width="100px";a.style.msOverflowStyle="scrollbar";document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var e=document.createElement("div");e.style.width="100%";a.appendChild(e);e=e.offsetWidth;a.parentNode.removeChild(a);return c-e};a.viewport=function(){if(d(window).width())var b=d(window).width();else if(window.innerWidth)b=window.innerWidth;else if(document.documentElement&&document.documentElement.clientWidth)b=document.documentElement.clientWidth;else throw"Can not detect viewport width.";
        return b+a.getScrollbarWidth()};a.addTouchListeners=function(){a.container.swipe({swipeLeft:function(b,c,e,d,g,h){150>e||a.next()},swipeRight:function(b,c,d,g,h,l){150>d||a.prev()}})};a.removerTouchListeners=function(){a.container.swipe("destroy")};a.init()};d.fn.kworkCarousel=function(h){return this.each(function(){var g=d(this);if(!g.data("kworkcarousel")){var a=new n(this,h);g.data("kworkcarousel",a)}})}})(jQuery);